Задание №3 практикума по С++
(в поддержку курса «Проектирование и программирование на С++»)
Напишите библиотеку, с помощью которой можно будет вычислять значения и производную функции 
одной переменной. Основные функции, которые должны представляться в виде объектов:
• тождественная функция,
• вещественная константа,
• степенная функция, 
• экспонента,
• полином.
Библиотека должна поддерживать (путем переопределения операторов) арифметические выражения, 
которые собираются из таких объектов и арифметических операций над ними. При этом необходимо 
генерировать исключения std::logic_error в случае передачи в арифметические операции объектов с 
другими типами. Также у основных функций должны поддерживаться методы ToString, возвращающие 
строковое представление функции.
Очередность:
1. Реализуйте иерархию классов основных функций. Базовый класс TFunction из этой иерархии хранит 
функторы для вычисления функции, ее производной (реализуется в п. 3), а также фабрику по созданию таких 
основных функциональных объектов. Создание объекта должно задаваться строковым параметром type, 
который принимает значения из множества {”ident”, ”const”, ”power”, ”exp”, ”polynomial”}, а 
также параметром, необходимым для определения функции выбранного типа, например: значение
вещественной константы, показатель степенной функции.
2. Реализуйте переопределенные двухпозиционные операторы (“+”, “-“, “*”, “/”) для поддержки 
арифметических выражений.
Важно: результат применения оператора к паре объектов-функций TFunction – это TFunction, 
представляющий собой «композицию» этих функций посредством соответствующей арифметической 
операции; к нему также можно применять операторы, тем самым строя сложные выражения. Значение 
выражения вычисляется при передаче значения переменной в объект TFunction, соответствующий этому 
выражению.
3. Реализуйте метод, рассчитывающий в заданной точке производную функции, заданную арифметическим 
выражением f(x) с одной переменной.
4. Реализуйте функцию, которая принимает на вход арифметическое выражение f(x) с одной переменной и 
находит корень уравнения f(x) = 0 методом градиентного спуска. Проверять сходимость не надо. Число 
итераций градиентного спуска должно быть параметром функции.

// пример работы с библиотекой, схематично:

```
std::vector<TFunctionPtr> cont;
auto f = funcFactory.Create("power", 2); // PowerFunc x^2
cont.push_back(f);
auto g = 
 funcFactory.Create("polynomial", {7, 0, 3, 15}); // TPolynomial 7 + 3*x^2 + 15*x^3
cont.push_back(g);
for (const auto ptr : cont) {
std::cout << ptr->ToString() << " for x = 10 is " << (*ptr)(10) << std::endl;
}
auto p = *f + *g;
p.GetDeriv(1); // 15 
auto h = *f + "abc"; // std::logic_error 
f->GetDeriv(3); // 6
```

Каждый из пунктов 1 – 4 должен обязательно сопровождаться набором тестов, написанных с
использованием gmock/gtest. Тестировать нужно создание объектов, генерацию ошибок, вычисление 
значений базовых функций и арифметических выражений (с различными операциями), формирование 
строкового представления, вычисление производной, поиск корня методом градиентного спуска
(например, для квадратного уравнения с целыми корнями).
Замечания.
(1) Метод ToString достаточно поддержать только у основных функций.
(2) Сложение двух полиномов не требует специальных представлений со сложением соответствующих 
коэффициентов (т.е. преобразования суммы полиномов к единственному полиному), аналогично 
для умножения полинома на константу и иных случаев, когда результат выполнения операции может 
быть с математической точки зрения преобразован в основную функцию.
(3) Производную функции нужно уметь вычислять в точке, нет необходимости реализовывать
производную как TFunction и выполнять символьное дифференцирование.
(4) Необходимо продумать иерархию классов основных функций, чтобы правильно их создавать и 
приводить к строковому виду.
(5) О паттерне «фабрика» можно почитать здесь: 
https://mk.cs.msu.ru/images/5/57/Lecture_pbscpp_8.pdf
(6) Вопросы по заданию следует направлять Владимиру Коноводову (vkonovodov@gmail.com), копия –
Василию Балашову (hbd@cs.msu.ru) и Алексею Сальникову (alexey.salnikov@gmail.com).
Стоимость пунктов задания (* – необязательный пункт):

Баллы:
1. Основные функции 3
2. Арифметические выражения 3
3. Вычисление производной (*) 2
4. Поиск корня (*) 2

Напоминаем, что при поиске корня градиентным методом используется производная.